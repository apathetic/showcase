<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>{{ page.title }}</title>
    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" href="/css/main.css">
	<link rel="stylesheet" href="/components/flexicarousel/css/flexicarousel.css">

</head>

<body class="home page">

	<!-- {% include _header.html %} -->

	<!-- TODO TODO TODO: remove from the layout and integrate into the index file. Need a "featured" list / tag -->
	<header class="">

		<div class="slide carousel" id="featured">
			<ul class="wrap">
				<li class="active">
					<div class="v-center">
								<span class="eyebrow">Module by Wes Hatch</span>
								<h1><a href="#">Flexicarousel.</a></h1>
								<p>A carousel that'll dynamically adapt its width: it will grow or shrink alongside a site that’s resizing via css media queries. Uses CSS3 transforms for its transitions.</p>
					</div>
				</li>
				<li class="">
						<div class="v-center">
							<span class="eyebrow">Module by Miranda Li</span>
							<h1><a href="#">Autocompleter.</a></h1>
							<p>A lightweight standalone module used for filtering data or autocompletion of user-input</p>
						</div>
				</li>
				<li class="">
						<div class="v-center">
							<span class="eyebrow">Module by Jason Divock</span>
							<h1><a href="#">Huge Slider.</a></h1>
							<p>An annoying scroll-jacking slider</p>
						</div>
				</li>
				<li class="">
						<div class="v-center">
							<span class="eyebrow">Module by Wes Hatch</span>
							<h1><a href="#">Parallax.</a></h1>
							<p>An elegant and efficient parallax base</p>
						</div>
				</li>
				<li class="">
						<div class="v-center">
							<span class="eyebrow">SASS Framework by Chosun Snyder &amp; Miranda Li</span>
							<h1><a href="#">Chusy.</a></h1>
							<p>A responsive SASS framework for quick prototyping and generating multi-breakpoint liquid grids.</p>
						</div>
				</li>
			</ul>

			<nav>
				<div class="prev"><span>←</span></div>
				<ul>
					<li class="active"></li>
					<li></li>
					<li></li>
					<li></li>
					<li></li>
				</ul>
				<div class="next"><span>→</span></div>
			</nav>
		</div>

	</header>
	<!-- =========================================================================== -->



	<main class="site result">
		<div id="tabs" class="">
			<ul>
				<li data-filter="all"      class="active">all.<span></span></li>
				<li data-filter="css"      class="">css<span></span></li>
				<li data-filter="js"       class="">js<span></span></li>
				<li data-filter="carousel" class="">carousel<span></span></li>
				<li data-filter="sass"     class="">sass<span></span></li>
				<li data-filter="slider"   class="">slider<span></span></li>
			</ul>
		</div>

		{{ content }}

	</main>

	{% include _footer.html %}

	<script src="/components/flexicarousel/js/jquery.flexicarousel.min.js"></script>
	<script src="/components/autocompleter/js/autocompleter.js"></script>
	<script>

		// ---- carousel ---- //
		var featured = document.querySelector('#featured'),
			bullets = document.querySelectorAll('header nav li'),
			carousel = new Carousel(featured, { afterSlide: updateNav });
			// current;

		featured.querySelector('.prev').addEventListener('click', function(e) {
			e.preventDefault();
			carousel.prev();
		});
		featured.querySelector('.next').addEventListener('click', function(e) {
			e.preventDefault();
			carousel.next();
		});
		for (i = bullets.length; i--;) {
			(function(to){
				bullets[i].addEventListener('click', function(e) {
					e.preventDefault();
					carousel.go(to);
				});
			}(i));
		}
		function updateNav(current) {
			for (i = bullets.length; i--;) {
				bullets[i].classList.remove('active');
				bullets[current].classList.add('active');
			}
		}


		// ---- filters ---- //
		var tabFilter = new AutoCompleter(document.body, {
				filterOnly: true,
				elementSelector: 'section',
				markup: {
					cacheData: function (el) {
						console.log(el);
						return el.getAttribute('data-tags');

					}
				}
		});
		tabFilter.dataCache = tabFilter.cacheCustomData();
		console.log(tabFilter.filterElement)
		document.querySelector('#tabs').addEventListener('click', function (e) {
			if(e.target.nodeName === 'LI') {
				tabFilter.filterMarkup(e, e.target.getAttribute('data-filter'));
				this.querySelector('.active').classList.remove('active');
				e.target.classList.add('active');
			}
		});
		/*var sections = document.querySelectorAll('main section'),
			tabs = document.querySelectorAll('#tabs li'),
			tab,
			filter,
			regex,
			tags,
			i, j;

		for (i = tabs.length; i--;) {
			tab = tabs[i];
			tab.addEventListener('click', function(e){
				e.preventDefault();
				for (j = tabs.length; j--;) {
					tabs[j].classList.remove('active');
				}

				this.classList.add('active');
				filter = this.getAttribute('data-filter');

				for (j = sections.length; j--;) {
					tags = sections[j].getAttribute('data-tags') || '';
					tags = tags.toLowerCase();
					regex = new RegExp(filter, "i");		// ghetto, doesn't care about surrounding whitespace

					if (!tags.match(regex)) {
						sections[j].classList.add('collapsed');
					} else {
						sections[j].classList.remove('collapsed');
					}
				}
			});
		}*/


	</script>


</body>

</html>
